#summary One-sentence summary of this page.

= Mac OS X =

Building libusb 0.1.12:

{{{
./configure CC="/Developer-old/usr/bin/gcc" CPP="/Developer-old/usr/bin/cpp" CXX="/Developer-old/usr/bin/g++" 

make CFLAGS="-isysroot /Developer-old/SDKs/MacOSX10.5.sdk -arch ppc" LDFLAGS="-Wl,-syslibroot,/Developer-old/SDKs/MacOSX10.5.sdk -Wc,-arch,ppc -XCClinker -mmacosx-version-min=10.4" CXXFLAGS="-isysroot /Developer-old/SDKs/MacOSX10.5.sdk -arch ppc"

sudo make install

sudo mv /usr/local /usr/local-libusb-0.1.12-ppc

make clean

make CFLAGS="-isysroot /Developer-old/SDKs/MacOSX10.5.sdk -arch i386" LDFLAGS="-Wl,-syslibroot,/Developer-old/SDKs/MacOSX10.5.sdk -Wc,-arch,i386 -XCClinker -mmacosx-version-min=10.4" CXXFLAGS="-isysroot /Developer-old/SDKs/MacOSX10.5.sdk -arch i386"

sudo make install

for i in libusb-0.1.4.4.4.dylib libusb.a libusbpp-0.1.4.4.4.dylib libusbpp.a; do sudo lipo -create /usr/local/lib/$i /usr/local-libusb-0.1.12-ppc/lib/$i -output /usr/local/lib/$i; done
}}}


Building avrdude 5.11 for i386:

{{{
./configure CFLAGS="-I/usr/local/include -isysroot /Developer-old/SDKs/MacOSX10.5.sdk -mmacosx-version-min=10.5 -arch i386" LDFLAGS="-L/usr/local/lib -Wl,-syslibroot,/Developer-old/SDKs/MacOSX10.5.sdk -mmacosx-version-min=10.5 -arch i386" CC="/Developer-old/usr/bin/gcc"

make
}}}

Building avrdude 5.11 for ppc:

{{{
./configure CFLAGS="-I/usr/local/include -isysroot /Developer-old/SDKs/MacOSX10.5.sdk -mmacosx-version-min=10.5 -arch i386" LDFLAGS="-L/usr/local/lib -Wl,-syslibroot,/Developer-old/SDKs/MacOSX10.5.sdk -mmacosx-version-min=10.5 -arch i386" CC="/Developer-old/usr/bin/gcc"

make CFLAGS="-I/usr/local/include -isysroot /Developer-old/SDKs/MacOSX10.5.sdk -mmacosx-version-min=10.5 -arch ppc" LDFLAGS="-L/usr/local/lib -Wl,-syslibroot,/Developer-old/SDKs/MacOSX10.5.sdk -mmacosx-version-min=10.5 -arch ppc" CC="/Developer-old/usr/bin/gcc" 
}}}

_We lie to configure about our architecture so it works, then override the architecture to do the actual compilation._


Building libusb 1.0.8 (http://www.libusb.org/wiki/libusb-1.0):

{{{
./configure CC="/Developer-old/usr/bin/gcc" CPP="/Developer-old/usr/bin/cpp"

make CFLAGS="-isysroot /Developer-old/SDKs/MacOSX10.5.sdk -arch ppc" LDFLAGS="-syslibroot /Developer-old/SDKs/MacOSX10.5.sdk -arch ppc"

sudo make install

# repeat for -arch i386 and -arch x86_64, moving previous one into its own directory first

sudo lipo -create /usr/local-libusb-ppc/lib/libusb-1.0.a /usr/local-libusb-i386/lib/libusb-1.0.a /usr/local-libusb-x86_64/lib/libusb-1.0.a -output /usr/local/lib/libusb-1.0.a

sudo lipo -create /usr/local-libusb-ppc/lib/libusb-1.0.0.dylib /usr/local-libusb-i386/lib/libusb-1.0.0.dylib /usr/local-libusb-x86_64/lib/libusb-1.0.0.dylib -output /usr/local/lib/libusb-1.0.0.dylib

# copy over other files (include/, pkgconfig/, libusb-1.0.la) and recreate symlink from libusb-1.0.dylib to libusb-1.0.0.dylib
}}}